// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

import "./ERC721Tradable.sol";

/**
 * @title VPunk
 * VPunk - a contract for my non-fungible token.
 */
contract VPunk_H2 is ERC721Tradable {
    constructor(address _proxyRegistryAddress)
        ERC721Tradable("VPunk_H2", "VP_H2", _proxyRegistryAddress)
    {}

    function baseTokenURI() override public pure returns (string memory) {
        return "https://www.buty-emu.pl/punks/metadata/";
    }
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

import "@openzeppelin/contracts/token/ERC721/ERC721.sol";
import "@openzeppelin/contracts/token/ERC721/extensions/ERC721Enumerable.sol";
import "@openzeppelin/contracts/token/ERC721/extensions/ERC721Burnable.sol";
import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/utils/math/SafeMath.sol";
import "@openzeppelin/contracts/utils/Strings.sol";

import "./common/meta-transactions/ContentMixin.sol";
import "./common/meta-transactions/NativeMetaTransaction.sol";

contract OwnableDelegateProxy {}

contract ProxyRegistry {
    mapping(address => OwnableDelegateProxy) public proxies;
}

/**
 * @title ERC721Tradable
 * ERC721Tradable - ERC721 contract that whitelists a trading address, and has minting functionality.
 */
abstract contract ERC721Tradable is ContextMixin, ERC721Enumerable, ERC721Burnable, NativeMetaTransaction, Ownable {
    using SafeMath for uint256;

    address proxyRegistryAddress;
    uint256 private _currentTokenId = 0;
    uint256 private PUNK_LIMIT = 20;
    string[21] private _tokenCode =  ["0908060A09060B08040713110313040A0F090D01030C0E0407060712110D090708120504FF060611010D1213FF070E0B0A09120700FF0B0C04120D120E09110C0B110613040A05020A080E0713080B130EFF130D0E120907120E090A07130B090E0D130D08030006010A13060D120B04060F130B1104120E0D030C00070BFF09070E060D130009080A13120009FF11120E0F0D050F05FF030B0B111106130D0F0F1100FF0C0F0F01FF0C0807070A0301000AFF1203FFFF060A060E02FF080102120813FF050112060B01020D1112060C00130C0D121312061109110C0A080A090911080E11080700FF12110C0005040D09FF110E06050B09FF0A000C070103040604130A0F1306090E060009FF0503090E06040C0A071111FF0206120C0E050F0A110404120B12050C060C0501110B08080F040D120B0F0D0008010303040102030C0B030D020D0D00080D0E09000411FF060A0EFF0111070F080609010905090E0113FF0308070F120602040F0813130D00060D130007021206010A020905010E0B1107120701FF13000F0E050306020A0CFF01010B0B060C0108040A03020F09040F0607060C04FF0B02010F0DFF12040200000413FF00020401020C020900010E0102080B010C0D06FF06030C040F0AFF01050A07020D0D0005000F0A070D0404130C130C030A0511130109120D0C00050307090FFF0D010E03050E030C060B0A0502130B070F0402121312030C060000FF110C120B010603010E0805050D0BFF12020F0E0D0B08040B1103051202130A12040E0A090D0E0B01090202FF0C",
    "06121111090C0D021301060E0D050A0E00000707090C000F090C010A0D00040E0C0B13091302030204FF120406130B01060513030A0B13050613000C030B000509FF050EFF020CFF0705030C07050C0807060A05010709020906110E12FF0A02070A091102000104120B050C060C0C0E13070C0D0F0F070C02FF05050E0108FF000F05050FFFFF13010D0A010C120B1207120A11130D060B0A0D000811050D1109020B130C010E0D0F0C0203110E0C060B0100FF130B070511010C0B0FFFFF0B0D07FF07110E070C0A11120512060C040A0B0302030C0A010AFF030A0B0A0E130B050A03071311010B12030903110F0F091106070F0E0C070907040809020712010B040D0A0F0000041209020F130000030F1207040900130D0C08080E0504FFFF0A0E0F0E070E1105FF0F00120D080201000A000C0D12FF05040604080D060C060507070305FF000711030208090F050B04110B011307060D0E0D09090F12FF13060AFF13010200090A110A0C0E09111301070100000107090700060E0D02120807FF0C090F01040D0B0D09110A09080CFF0E08080E0F0107130B0F09020611050004020C0E0E13130B0D04030A00FF0D0D030EFF0C0F090C040904050304090306120F0D04110213000A000B0704050D090A090D090A0007040E11000A080A03080E0412010B0202010201120304120B0D0703110B070E1101FF0DFF0402020C06080900000009FF0A0C0E0A0B13060F030F120E03010F05050C090904FF0C09000B0308040E0EFF041204060D070700070208070503FF0E06031304080209",
    "0B0B0F110F0601001106FF0D051312110A11FF0B090207080B12050AFF0E110F0D030E010FFF0F0D0C02FF05010D0D0106000A011205080E0103031308000C0A020A04030A00010908090F0D0904080A05090503010C0B000A0C0C0508070E0D0F0112FF090F08110C0F0311080C0A0502FF03130306FF0D120A0C130A0613010C0C070603070F0C0A0C03130A0800050209FF010405FF130FFF05110B13000904FF0D0E0401030A130307090311060C110E060E0C010AFF120E0B020B010E09000A0503040500080B0A091306030509FF0A12020A0D091103090E0D120606010C05000507130D0506110308050A0A080B0D110A001304FF0505031111030A0C130A08080004FF030200080400000F000A1108020A11020D020701FF131111130B0B13130F120D04070B0D111305FF0D0C0C0C000C1108080D09010B0DFF0C08FF020A00020B03050005071303070D13020912000F080E12040D07000F0200110A121103000503130002060E0EFF09120F0A03110508130008031300FF01FF0D0D05000D02070E070F0102130D11010B080104060D0F130E01120F020BFF030E030C040107000C031208110EFF0D0507010F0A090D010B0302020004120702120B090E00110D040A0D070001010D03050B0D050D03110B130102010E1111040904060712020E1106080A06040D1307120512060E0B0E0009130D040212090A03090F0403070E010D050E0309040B040902010902000D11130A11FF070F0A12031308070D0B091309060908130313000C040F0F0507020F03080D0E0608110313",
    "0A0B13080400130E1311070208080811060A130C0002110B010D0312FF0709070C050C05070C0E0D0600060B0F0B0CFF08050302051205120F0807120E130905110FFF020B0F0B0302FF0D0509FF050B0313070B0C0C0411050303050D02050D070B110906120805120312FF0D0D070E0603010AFF09090CFF0300FF130504010C0F03030608130602000A0E040D030802110FFF0603001102060307020E130306131300090F02020805080A11020F040D0C040E0AFF080B0408090403040EFF0E0C060D0007120D0F030213070A011209060909FF0E120213040B130408070D090011090E08120513120E050412030AFF010B0B06010C031200030708090DFF0C0D0A00FF0508060B010B07130F00110808060F0704060B01020B0D0906060E131300040D0708010201040A040AFFFF111113130D030C050D000503040C0F0507010B110B0EFF1309FF120A011302020D060908FF0BFF080A0008060C12031304FF010B0612010801030F0612060E07070C0B0F130B03070E040212000511090B11060500000112090A110FFF0D0B0F0803130C020F020E01130A080FFF07030C0304060700010606020A050F0D08130112120900040909120F02020D070F07000A0F0805090E12090E081209FF010808131206090803110F11080B0F08020200FF030A0505010C09090808010803FF0505060B0C060E010A0A1101130108000A00FF010601000B0A03060E1301FF0F130E070C0B0811FF12040A02001313030F050D130A000711110A0A090D05070B050803030002060D08000B000E030E12",
    "0307040B12080C010E03120707070D11120F0212FF0E02070A050D120707000F0C070511110A060D11070601010104000E0A0F0F010E080B09FF1102110411030E04090E05110D0C0C03080609020B1209070A0304070307020812000C1304130E0203030B0212FF0B0D0E000F130C0C0109010002060F080004020209030E0F01FF0D01110D07031102080A09000F080B0F0C0E03080C0F0E0A0A060D0EFF070B1307070E05080E00000A090E0611070F080C07FF13000F0A050E09040A00FF040C0A08FF04050207FF0D0E070109020C0A0D0C1111030E0C0D02040F0F0C03080902000B030600080C120C08040F090C0F090E120D0C0B0302080A0F0C12090111FF0C080200030208090904090A0D04050C0A05020903060E0901130F0103000102051104010FFF050C0B080F110F0B1300060A010F06110607090B0B0A0806110C0C1311061311050D11080E00090C05080100060F1309FFFF0506090302070F0D090A120D130B1107080808130FFF12020BFF0A0107030F01050104070108080901130E091309FF0401FF0205020A0E08080A050A0011000E060E050F0513060A040000FF0006010603050C08120105FF13010D13FF020B0E09000208070806010F050D060512010DFF1109120E0E0009FF040B0B0AFF0C0A070A09130C05FF0F090801FF0B020506070C05060C0A000606010603000302FF08010211000F070A040E03130D011108130E0D0C0F031212131100020B0411060C00FF010601090F0B060007040D0C04060100020A0D010C090D0F13010C010503090C0A04",
    "01040713120907040007FF0F0A0F0D040201FF0DFF0A020705130907030F12FF130F020B08FF07040A050B0D0F0F0E05130B0513030F09120E070202050C040D0211FF0306FF0A020906080907110D130F0B02000002050E080D0F1112120F01130D081208020105010B02080202050A040605110AFF05FF030A090FFF130D06060B061308020403020F0207010D050F0305130A130D0413FF06FF091207110D09FF121111070E0B0B06040B06010704090FFF050701120D0B09030C12080D0F060206000DFF080509020F00090000040F0A02091100070B080301090B00121206FF0F0D07010811011301071113110E13080B120707040506080B00110512110F04130E0E01090A0103000C00050E06120E1301050D040DFF090B00070401080D0A0604FF080913130A020801020F0C060C08120A0D13FF0E0405080E09110D08130900110005FFFF06030D0004011109070703FF00110D0501040E00080905030A0709070EFF120813000A050801080E05010E070E110C040E0A0E0C070611FF040A0D051203050902050E050E090B05120B080C03030B000B0D0008011313030D0D1212030D1308110E11021201040112050403051311110F070B06070712080A07130605041304110F12090C03110613070911FF0D110C020A0F0BFF0A08050107FF0E110D0D07110911120D0F0A01000C1105020C050F0304130A0D060103071102050A00080307050C0E0B0806110F05130C0D070F02120701081301010A0B040E12070607120A060C0C04FF0305FF08FF040E0B0A0111FF1306120509",
    "FF0C0802000009130E0A00040C0F09060F0E06090B0E0B090104020F05000C00050B0306120C0904040F0E01000206121213010F12090704131208110A0402010A03070A05130F04060FFF0C0C0FFFFF000A110A0A0E0B0201050713020A1312030707120713000A11020304120C040704130B060F13FF0F060B04FF06020D09FF070709130FFF0C13FF12050D00090602060A110B030C0E110E130907110A090E0313010B0C060A080209080A06120213050D05050700020F0E050E03090112FF03110813060C0B120DFF0B1303080F0F0C0A0D02080303130F0FFF0D02FF0803000D0D090213090B0C0306061206040EFF0900040D0C0011040C0A0212030D0C11050400070505070F0608130D030C0F081311FFFF05080C0812060B060209000007020F1204050D0A0C0211040E11FF120601130F0B050A0D04010E080F070F0F040C030C130608030A03060411000D0A00120B060B110A090304080A0C070D110A0AFF120B0E0A110907010D0F07FF0A070D0209130D120C06080E0B0C020C09050A0E080E08080BFF0E0C0D080E050500020D030E0B0D070C00050707FF0F050C13FF0FFF0407060903050E120D0506060B01000E02000306070A050C080F0E130B0B0E0D0F110B0E01080D0E090F1213080E0D06010503020C080C0D070C080E0008090701130811030C02090D0E01060C0B080B020C0FFF04130D06050A04110012120D0E050A070C050D06120B13FF05110D080513040409010C0DFF0A1203010A07FF0C13020411130EFF070304030700070E0E1304000612130B0B",
    "1205110C04131112010C0607090F11060D12090C110D040F030A04030803000702020E0E110D0B0D0A0412010B080807020E020306051205050612050305120903130A1111071211000E0001120E0702090605080B03110D0B0102070B0A060B13120001040B0C0A120711000103020B0C110E0800000002130D07090E1203040B0A020112060D13000A0E0A020D000D110B0E11080A0D0A030F0D0006120C0D000111010B0E08020E120D070CFF1305FF0B03FF000912110E0902FF110A0F020506121312010F0F041107010D05000C0F090A121101040C050403FF0A0E09000E090B0A0006050301120D080D0B0D01070712060B00060C06130606110B05020B020601FF0900090FFF020BFF13030DFF13020B11070C020C0B1202020111060C0A070D130309090A0B04FF120B0709130EFF03070F03130A0A01040408020904020112110A0C0C06120E0001121112FF04061211090E0F070E120013110B120A0E0207020808090C1211020C0111FF130508130703020406051201050800010D030A0004010D040B080D060D13010F110B09000D07030708130D00050C12130D030A0802070F0F040D09040A070B13FF0B0F0C0209130C080E110A000A050D04000A0F0F040EFF0B05120C010E06110E010E030E110DFF11FF0108020409FF06020DFF0F081202040F0207070F01070D07120C130F0A050B00030B060505FF0B040B04010000080E0B070900040C02050F0A0C0D0A0E1309040C020A0E0F0900050C060E0901060F0005020F05001100060D0405FF04130513090C03010E05",
    "FF0913FF09120C0E0103131102FF0612000F060006000E110712070B0A0500021104090509FF0EFF120D0A0E0A0F00030608130E060C0407090DFF000D00040C061303010A01090606130A06060B07FF090204020C13080F06040B1103050B090B04070502040E030D13020111110A130E0D0F08061208000D1103090808040302071306030111060D1205020F0F0003130012130B0A130F0500070E000A130206020302FF030C1204040E070A0D010A070405130000040A0CFF0503030908040D020312050A0107030C131307111302050413070D0806FF0807080D0B0303000D1213080C09110901040408040C120B0B0CFF12030E070512110C03060A0E020B0E07060B0A06090CFF0B040407000A030D080704030B0700091303FF04FF0A081211020003030C0C130E000E0E09130811040E010E090F0D040F060F0A0F13080D04000E090BFF0B11010F0204FF0C0B13010F0D0F0C050EFF08FF050C0906050D13130B020E0A010613FF130D0002FF120AFFFFFF0E0B13050D0A0D0C090E0E0B1205050C11FF0FFF0A110BFF020B0F130708FF04FF1106FF0C0FFF130F040D050A0D0D05050D0D0409000612020E0B060D05070512070A060003060F0A000D0AFF03010F06040E0F110E050A090B0D04010400131206FF0F0C001106040B040C040205070208020C0F04060F120702130C0EFF090C120F0602FFFF04030807080D00111100060E120A1107020C000C0102030E0C0004010E04FF0F111103020B020CFF12030101070D0B0C0D1204110E05060A08FF110E0C00050B000C04",
    "08040501030E050A0B08070D1200071203FF0D0AFF0302070A020F060F0602130E0A1206011203090012040613020E0E050BFF1207020608000E110506030B1107090C060D0B0307090B08130B130C060EFF010507041207FF110302121202040311020311010A0D110C07FFFF0C070F02130703110C0212060303110E0C0C0F0311120C04070B0F0F0602110405010EFF040C080800050209130B010309130A060D0FFF130F0F020D0C070B0F0B0E080C1213020E110B11060103010C0900020D0E05FF0708010B0B05020500FF0C0F09FF0703020B0D0B05000A1309FF12060E050911110BFF0300FF01090013FF071111040F000F0E090705060C000E070D010C0F11010A130D04FF06130FFF050E040B1212080F080D0100020F120301000F0D0FFF0F0D0B0112010A0B050305120DFF0903010B0B0B00000E00060D040701131202090D0700110411050AFFFF1107040112120C050906020807110D030E091302060EFF0505020A0C0A07020E1109120202FF020C02060A07FF110903020D0B01050E08120001110F0112130C130500020B120C0502041307040608020A0608000D0D040311001304050109FF0F0805030013FF12FF070C110309030C1207090D0F060F0E050C0E0BFF0F12110E0511FF0B040A0D050E040813090A08070A0B0305FF0B0311120E0D060513060D03FF090D0407030D01080C020C03020505050708000208120112FF0F0209080803000F0811FF1104120E0A000A00FF1303080A13020D030B05030E120503120012120F13110F1301051105130D0A0F0E",
    "0F090E12060B0C0F050D050D0C0C090F1105060E0313060402090E0D020604060A05040F1309031102010B040D11060D0F030D06010B0400130E06110A090705FFFF0F0D0C0613030905060F020407130803010911020DFF0A0A040B01FF110501130504120F00070B0E12080E07110B0E0D090800051104060012120CFF0806110E110B090D1207060C00FF030706080802031306090F0F0F0807040E130BFF010E0C0E050D030D0505010E08000A0C051312010F0409030609110C00050F0C040F03040E130812000A120E13080A0B13130F0D010EFF09120F000F0A13020B041313000B000C050E11060811060D0A03120108000308070900110C0F0F040211120C0C0113060B110A110C0C091204070F080B04080D08130D0D060D050106010F130C05FF0901000E13080B060C060B120B0604120DFF0211010003061103010901120302040E0B130AFF0A0A070E0C0F0105120E0F0F090900060C040D120608080B020904080F0912050F0006FF130900110F0802110511110E03030C120311070E130C0D0B010E0A13030B1313080E0305121306010204FF12080F0006080A0106020B07FF070A0A0905110EFF03020A0D0404050103040404120208120D12130C01060A01080108060301111108010B0508040BFF080002010A130A0F0E03050A08070402FF030B090B0303020304040D000F08120207020F0B090312130B070B0F01000400050306050D0CFF0B0F0D020E0F020D06050100FF050F000B0803060A0007090F06120D130107070E0902020411080F01120B080C120706",
    "011213070D120F030E0A0305120E0D03080106090811040A020B04080905120A0D04FFFF030A050D1300070F0C0C0707090B12FFFF070604050309FF1105110F0A0D0E06000E06120D0113041111030D0C010E1306111104080D030B000B05060D000609110500010D0C0C04070511130A0A0F0E05070300FF13011312010204120B06000C060C0F081300030100020413FF0109090E11000D0D04090E0C070F0C0206FF120A050505010B061200020B000B131303110705021105000B110705040F0E010C000E050A110E07050E0B0C120405020E0F0A010F0A0F0F010802FF120A0B0606120E0F0B050CFF010D060F0304030704060612120F130A0004090EFF0B090B13120C07040106FF0B081213FF120F0F0F080C0405090C020808040B0903070CFF07120D130A0905060C0F03070600071309060F040A0A020C0F02050F12000312131205000F080809FF030704090C110512000C0402070E0D080E0C0003120D040F020F0400130A08110F030500010D0600060A0C0D05000F11040FFF02FF000D00130F12FF120D08040E00FF0105090A03110202080A11FF120D110D050E0E0306000B0403110E09120D030D1208130D05080D0B110307020E06120D11090C03110E07060A060B09050A000F06000B0C02060BFF0B0205000A0FFF000D0F01070E0703050D04120C000E0B02000A0D030D0A03080D030F01FF01030B0D0809090B03120B0E01090A0B12080E0E02110D0513010B05FF0D0C070E0E120207041204130A000A03020B050F11060D12FF00131107110E030D05090613",
    "110F11020B0D00130B12040A0D0A0F0DFF080102040E0D0F000D12011300020A0D060E06110D0F040B0A04000C120A0EFF000607000E090E06FF11040B12020204070F0B0C1111060004020F0A03090E080306090D11050A09FF03FF050D02030A0E020E0F130C0D130A0F0F04050213060A0504010104090A0D1101FF02040B0E0F000500FF0103070C0A0809020C120B081201040D0A0E020C0812130D0805030D02130B0505040B0A030307010903060B06090B0A0C0C111302020F01060900130202050B090F1200130A110A0F0F01FF051313070E0D0D01040C020E0A0A07041102040101010D040C0B091201130503FF0209020E060708001206FF0F0E07050906000A0D090E0D1105070C000E0D021212040701080D0A0E110C0306050C131207040A02040D02020306FF1205010E1311070B0B130C0A0A120B0A090B0408110B1308030B070B130902060F0F0C0D11080A0D010C0707070500120F1211020C000E050A0D11030A13FF030FFF0D000F0E110B070F0D0B0A04120D0DFF0604010E020E13060D06050511000201FF01FF091113050D0F0307FF000E0903030C080F1106130701060409040813090A0F04010B040C000A020313FF07070F06010D121202FF0512090A0B130409010F0511080F130F000B0C01020512110B091307030C0F0E02110C0E1212090D0F040409010413040002FF0E0411070600030A12120401130B050B020E0E020D0A09020C0B0F06080D04050C08130A0209050201020E070E0E0E0D0A03090C020D0004090713120213030403040EFF0711",
    "0005FF0B0B00FF0E0D04120E00030F020F0B0012FF050A0D02040E0C050900020D0E011107110E0E0900120EFF1300040204FF06030212010D0C0006110D03020A030B07010707000A0B0EFF0207080F0C050109FF0607080F08020F050D120A0C05060C08070E0B0C030A0DFF0F04110D1303010B131311030B080207110F0B12080E0B0A0F0E120303080807070D0F0D01041207080002060102050D0C0311050403060A0C0712011105011302110809010C060C08050D0C08001208030000130F0F0F0D13050B06070A0F110C0D0C060A0D0A04110111040008120C0D0E0E02130A001308020F000D09000E0B090C0F0E00000E0E0E000DFF04020B0E000A01FF010E090D070F060C06090A0C110F130F0A000A0209FF0B0E0204FF0C0009050F0F0C07090007071204130E0109040107121107021312001313131306FF0D00030B0E060D0004FF0811000C1103130B02090F07FF0B0C0313070D01090E09010A0C02000608030E0A0C0F0208020C00050EFFFF0C090409120402020711011300FF0D06110F0001020408FF04130D0A0A0B0C0EFFFF0013050B0C110D04FF090BFF0600120300FF110402FF070C0302110E09020B0807130E09120F0B130B0304060312091208040C0F070F130E0D070D1213110F110C05031309080504001208010C1112030C110F0812110E0305130C090BFF0F13130D11FF120E03080B030512050A110A031301090101050B0508130E0400020F0413120306110006070F03030F080E020D030A010F0A02060A030A0F0507030D09FF09080400010112",
    "120B060A0E0501030D030E03130B02000B12040A070FFF0D04130809120F010B0909FF01041300000109060D0002120004FF070B0911FF0C0FFF050F04050F0F120C0A0312020602081213130E0404130A11050A1108080900120013130811080C0912000EFF0913080407FF12FF080C0A040D0A040912000701080A0E0606000F0B0004010607000F04FF0C01090C1308FF090E010612FF070413050E0C091104130303020B1308090F0C050F1200020802110B040BFF00070F0F0A0A090C0EFF05040D0D06FF0F050006070C0C0209070C11060103090508090906031203020402FF0F1301030B13FF0B010D09020211FF09051203FF03FF0B080912030A0E0902FF010502010DFFFF00050A0A0D11000E04030908081102000E0E120E030E0C0E01090C091301060B010F0E04070509090A0D0F110E0502050F0C01050A13050A06070E060B0A060C050106010D0A070F09010711050211120512080C13020F050E0701060203131205030A0E09050C0A0D06120C0C000A080F11110F030808000C0B030C11070AFF00000E07060E080E0B0A080A040B070903010712080B05090C0B060DFF0C010407FF0F0C06060E02020D13111212080B0F050F0F03090701020D020F0E060C12031201050B080A010F0607070A0D030412FF13000D070D0B1100000B0305020C0E0213030A0413020D0A04110F02081211040602070F11070E0F130E0B0D00031207071102010F0C0E050B0512030E0E0A0B0804050606010F070A040CFF041202110A0F0C0F06070D000301070B121204120F000E01",
    "0108030DFF0513010903120B0504030B080C020811080B03071300110A111102010F050A0B1313130BFF0212130A130D03010A1303130908120E09110D0C0FFF0D121207000C0E090300FF000700080C0E0B0A0206130700030108060200120E0F0C0C09070708030A02060D0C0B1306090E040C090E0F071111080511070004060B06120202120E130B13070006020A0A1203030D0D0D03090E00130D12FF0F04000C0605030DFFFF06010D0F120B0D0F04120A0F0D13030D120E001104010601130902020C0A02FF0E05050E090A0E0D0B0807130503040507030D0A07060DFF05120F0C1103050613FF031311080D0B0408020804030400020A040D020D02030A06060C0D0306030B0D0C0902030C090E0E080A06120E0F00FF0F0C091305FF130DFF0A110008030506090F120B0B0011110613010C11010F020C0C070D0C130F0A0D0A0D070106090E0D050603110E090309020E1105FF0501081307020B0A020D11020F02020302FF010C0811050D0D080B120B050A0D040B0F040B130C06FF0F130503FF0907110B0E130706031306130411FF13120709130F080807050D00080205060808020C0613040806FF050903060C06040C130C13FFFF0E010904120A01080D090308000B0A0201080508060309130F110A0805060813110E00090606060B030B0503FF0E0C0D020D0A0C0E0D130F110B110C0107120C0D000106110B0B0100030D080602050611030B07020C0A0811FF030C0E0805FF0005000E080812000F04120E0E0E050D06030B0B11030E010F0112040E0F0C010B1209",
    "060712FF03020C070312070B13FF07001302030709030907120105070603FF13130F090001070312070211130F06FF0C110903080B12130500120E060C060D110F080B11020B00120D0B00090F020404050D030202120401090907080D0F010109FF0C010908FF05FF050211030C0908080C030508FF0DFF0A02060AFF1304050E0F010E030F0A0E0F0006050807050807070202070803FF060A090A0B0F0207061202020D0311060113110A0D0E061308050C04080C010F0A000B021103110A05010813070204FF130304030605040D1304050012020703031207001112050D121113020D0603070808FF0CFF0313020A060B080D110F0205070AFF0F0A0000090FFF06030111FF11110804020611041107060C0C030F0B060905130111080C010D0A020C0DFF060B0B06130B1208090D060C12110A010C010A1300120D0A0B040707080A070A0BFF0C060C010011120B13041206010F0F050C120708020B06060B12040306000803121309010B11040F061311050713080A0F061103120F0E0911FF0508130A120813000601091309110913120008120F0B0407000209060600090D02070707051300060F1304010E05090C0C041307FF0F0C0C00120E0001040F0D0F0B13080603010B010C0F0002000F040506130F0B0A070D070805080B050709001104010F070E0503131206060C0708050D1207110A06130D0E0112040C06130B0E0F0E0C08FF13111108FF130D03080C06FF0B0004070A0E0C061104050C09130A0603050708091105040201090C0A0F030A0D090106FF0B07020F04",
    "0B0C010C0F1108030B01110A00040C0B09FF01FF0E090C02090A0F050B0F1105120D11120511070004031301FF0A0909030705020402000F09010F12FF0908130C000C080A0C0C000E0C01000B120B000F07030D110B130400080002120A0A0705FF1200130DFF110011030E0E0A05070809040A09130808020D000CFF080C070000FF030E0407070B0B00000F00110E0B080100111109000C0413000D0306000313FF12061202FF0F1104011106130D110E021204060903010D110206080403050009110B11FF031309080B0500120B03050B0D010013060C0B1304060613090D0A0C081102130B03070B0C0B080901070E090CFF030212070B0A0A090F04020BFF010F0306000F0C0E070A03060808090A08130807010D07131203020A020A03090903110103120C0F130E090D0D00050F050B0C0A0D0A0D0C010800120A000D0E0C0C0C0E0A0B05020C070C1211091209050802120402060A081101010F070A130812070E0901000109081200060D0F0A0D090BFF01120B0009010601090102091108000AFF080B05110E01000E02060308120C0D070D080A000804080A0D0104060A110D0F070D050201110B00FF090B120C0E0A080202FF1300FF110FFF06030D0EFF02080E090A1207090A0F0609FF13120611000703120113000D0E0C110C1302FFFF09FF13060907020E030E0D0B08FF0D0F0BFF130F050D020709110D120802070F001203020D13120502080C0D05090109040C0EFF1305040404000511120E00FF0D0F020E03130B010A080F0D010A08090F020201130B0E010B07",
    "0D0E110F0C0704070FFF0A0D050A0C04130B0F03010B11060E0A120B0C11040011010F0604110F0404030C1205010308FF09050A02080F050EFF0AFF0207090C071312030600030A0912020D0907000201070D03070F0902130D020B1213010A0F010104110B0D060F060A0D03070C0C09040B0113040B0D0B1307000D0611FF040508FF110306061208020E03FF120F110F1304110F05040B0000120713020CFF0C040813120402080403090E1205070AFF0A0406120F04120F12030CFF0F09FF03010D13120011070E0800090E0B0A0B040D120D0812010E010D111106FF07060C120A0D1312130708070F11010A0B09020D0A0E081213130A07030D0012080702130512030411010E0D1209FF070E05021200030E000108110F040112060F0703050C050F13120908FFFF020BFF00120606020F0D060A130D11081301010A0A0808110F03090A0F0A0D0A0707020206120905090C0711000AFF07FF070D0C0A050808130C13030B05020F08040404060B04040E12020D070D08120B12080C0313000A0108FF09120A1208030A0B000E020907061313080000030C0C130A0E040F0D090F04FF0406120804020909010C0EFF09030F080C060408090003001200FF0B0B0211110B0200FF0B010BFF0F020F0C010600FF0E05080F13020213010605130D12120B030F09FF000305060E0C0C0513130B0B07FF0804020E13120F0700000502060A0907130006011208090613FF04120CFF0404060113FF080F0A0C0B09FF08FF000BFF12060D0D0300060506FF0A0902FF0301FF13FF050B0102",
    "130B010D0207FF0C0A060C0A080E060C040C0D0C000205110B040007120E12120407030102110404040F050DFF0D0B04120A03010103020B0305000F0CFF0D0C0313080009080B05080502090505080F0A0C0F0312010603000912011112080A0807040005070BFF060212130B0512060102040B0A00090B030E00080413010807120F12FF120503040D070213FFFF02120208080806000704FF080F0FFF0401FF010FFF0604010F01060709090305130911040011020E09080408040B0B0A01020DFF0F130513120F060511120809080905090912FF060201020008050F000C021309030F030809020706050C12020A110413FF0913050C08050700060F12020A120E0A0A130F040C02120A03080D1104070E060E1307110A110D120903FF09061207090F010912FF090F0A0C0312010707020401FF02131105060707020C071309FF080B0E0F09060F070906110A03050B1211010B08FF020003060F08040413080A0C1112040E0A0901070911051102060C0A080507FF0B00020F0000110E06081101050B1312120113130908130D021311060FFF020D110201120F080A010E070A0C05120B03030D1113020E13000E030E040D0C1203080211130A130B070F070A0A0F0A110E01000F0E130E0E03040D0F12030C0602070A0E0E030A060D0913080A08040D0B0B030E0907000D0502000104070709070102110511000A0506080E03000C0E0213070501120A110C06060C0B060A090411070103111211030605000900050809010D11090903FF080C0708FF0EFF0D0105FF00040D02020F",
    "00FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF01FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF02FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF03FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF04FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF04FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF03FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF02FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF01FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00"
];

    constructor(
        string memory _name,
        string memory _symbol,
        address _proxyRegistryAddress
    ) ERC721(_name, _symbol) {
        proxyRegistryAddress = _proxyRegistryAddress;
        _initializeEIP712(_name);
    }

    /**
     * @dev Mints a token to an address with a tokenURI.
     * @param _to address of the future owner of the token
     */
    function mintTo(address _to) public onlyOwner {
        uint256 newTokenId = _getNextTokenId();
        require(_currentTokenId<PUNK_LIMIT, "Purchase would exceed PUNK_LIMIT");
        _mint(_to, newTokenId);
        _incrementTokenId();
    }

    /**
     * @dev calculates the next token ID based on value of _currentTokenId
     * @return uint256 for the next token ID
     */
    function _getNextTokenId() private view returns (uint256) {
        return _currentTokenId.add(1);
    }

    /**
     * @dev increments the value of _currentTokenId
     */
    function _incrementTokenId() private {
        _currentTokenId++;
    }

    function baseTokenURI() virtual public pure returns (string memory);

    function tokenURI(uint256 _tokenId) override public view returns (string memory) {
        require(_exists(_tokenId), "ERC721Metadata: URI query for nonexistent token");
        return string(abi.encodePacked(baseTokenURI(), Strings.toString(_tokenId)));
    }

    /**
     * Override isApprovedForAll to whitelist user's OpenSea proxy accounts to enable gas-less listings.
     */
    function isApprovedForAll(address owner, address operator)
        override
        public
        view
        returns (bool)
    {
        // Whitelist OpenSea proxy contract for easy trading.
        ProxyRegistry proxyRegistry = ProxyRegistry(proxyRegistryAddress);
        if (address(proxyRegistry.proxies(owner)) == operator) {
            return true;
        }

        return super.isApprovedForAll(owner, operator);
    }

    /**
     * This is used instead of msg.sender as transactions won't be sent by the original token owner, but by OpenSea.
     */
    function _msgSender()
        internal
        override
        view
        returns (address sender)
    {
        return ContextMixin.msgSender();
    }

    // The following functions are overrides required by Solidity.

    function supportsInterface(bytes4 interfaceId)
        public
        view
        override(ERC721, ERC721Enumerable)
        returns (bool)
    {
        return super.supportsInterface(interfaceId);
    }

    function _beforeTokenTransfer(address from, address to, uint256 tokenId)
        internal
        override(ERC721, ERC721Enumerable)
    {
        super._beforeTokenTransfer(from, to, tokenId);
    }

    function tokenCode(uint256 _tokenId) public view returns (string memory) {
        require(_exists(_tokenId), "ERC721Metadata: query for nonexistent token");
        return string(_tokenCode[_tokenId]);
    }
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

import "./IERC721.sol";
import "./IERC721Receiver.sol";
import "./extensions/IERC721Metadata.sol";
import "../../utils/Address.sol";
import "../../utils/Context.sol";
import "../../utils/Strings.sol";
import "../../utils/introspection/ERC165.sol";

/**
 * @dev Implementation of https://eips.ethereum.org/EIPS/eip-721[ERC721] Non-Fungible Token Standard, including
 * the Metadata extension, but not including the Enumerable extension, which is available separately as
 * {ERC721Enumerable}.
 */
contract ERC721 is Context, ERC165, IERC721, IERC721Metadata {
    using Address for address;
    using Strings for uint256;

    // Token name
    string private _name;

    // Token symbol
    string private _symbol;

    // Mapping from token ID to owner address
    mapping(uint256 => address) private _owners;

    // Mapping owner address to token count
    mapping(address => uint256) private _balances;

    // Mapping from token ID to approved address
    mapping(uint256 => address) private _tokenApprovals;

    // Mapping from owner to operator approvals
    mapping(address => mapping(address => bool)) private _operatorApprovals;

    /**
     * @dev Initializes the contract by setting a `name` and a `symbol` to the token collection.
     */
    constructor(string memory name_, string memory symbol_) {
        _name = name_;
        _symbol = symbol_;
    }

    /**
     * @dev See {IERC165-supportsInterface}.
     */
    function supportsInterface(bytes4 interfaceId) public view virtual override(ERC165, IERC165) returns (bool) {
        return
            interfaceId == type(IERC721).interfaceId ||
            interfaceId == type(IERC721Metadata).interfaceId ||
            super.supportsInterface(interfaceId);
    }

    /**
     * @dev See {IERC721-balanceOf}.
     */
    function balanceOf(address owner) public view virtual override returns (uint256) {
        require(owner != address(0), "ERC721: balance query for the zero address");
        return _balances[owner];
    }

    /**
     * @dev See {IERC721-ownerOf}.
     */
    function ownerOf(uint256 tokenId) public view virtual override returns (address) {
        address owner = _owners[tokenId];
        require(owner != address(0), "ERC721: owner query for nonexistent token");
        return owner;
    }

    /**
     * @dev See {IERC721Metadata-name}.
     */
    function name() public view virtual override returns (string memory) {
        return _name;
    }

    /**
     * @dev See {IERC721Metadata-symbol}.
     */
    function symbol() public view virtual override returns (string memory) {
        return _symbol;
    }

    /**
     * @dev See {IERC721Metadata-tokenURI}.
     */
    function tokenURI(uint256 tokenId) public view virtual override returns (string memory) {
        require(_exists(tokenId), "ERC721Metadata: URI query for nonexistent token");

        string memory baseURI = _baseURI();
        return bytes(baseURI).length > 0 ? string(abi.encodePacked(baseURI, tokenId.toString())) : "";
    }

    /**
     * @dev Base URI for computing {tokenURI}. If set, the resulting URI for each
     * token will be the concatenation of the `baseURI` and the `tokenId`. Empty
     * by default, can be overriden in child contracts.
     */
    function _baseURI() internal view virtual returns (string memory) {
        return "";
    }

    /**
     * @dev See {IERC721-approve}.
     */
    function approve(address to, uint256 tokenId) public virtual override {
        address owner = ERC721.ownerOf(tokenId);
        require(to != owner, "ERC721: approval to current owner");

        require(
            _msgSender() == owner || isApprovedForAll(owner, _msgSender()),
            "ERC721: approve caller is not owner nor approved for all"
        );

        _approve(to, tokenId);
    }

    /**
     * @dev See {IERC721-getApproved}.
     */
    function getApproved(uint256 tokenId) public view virtual override returns (address) {
        require(_exists(tokenId), "ERC721: approved query for nonexistent token");

        return _tokenApprovals[tokenId];
    }

    /**
     * @dev See {IERC721-setApprovalForAll}.
     */
    function setApprovalForAll(address operator, bool approved) public virtual override {
        require(operator != _msgSender(), "ERC721: approve to caller");

        _operatorApprovals[_msgSender()][operator] = approved;
        emit ApprovalForAll(_msgSender(), operator, approved);
    }

    /**
     * @dev See {IERC721-isApprovedForAll}.
     */
    function isApprovedForAll(address owner, address operator) public view virtual override returns (bool) {
        return _operatorApprovals[owner][operator];
    }

    /**
     * @dev See {IERC721-transferFrom}.
     */
    function transferFrom(
        address from,
        address to,
        uint256 tokenId
    ) public virtual override {
        //solhint-disable-next-line max-line-length
        require(_isApprovedOrOwner(_msgSender(), tokenId), "ERC721: transfer caller is not owner nor approved");

        _transfer(from, to, tokenId);
    }

    /**
     * @dev See {IERC721-safeTransferFrom}.
     */
    function safeTransferFrom(
        address from,
        address to,
        uint256 tokenId
    ) public virtual override {
        safeTransferFrom(from, to, tokenId, "");
    }

    /**
     * @dev See {IERC721-safeTransferFrom}.
     */
    function safeTransferFrom(
        address from,
        address to,
        uint256 tokenId,
        bytes memory _data
    ) public virtual override {
        require(_isApprovedOrOwner(_msgSender(), tokenId), "ERC721: transfer caller is not owner nor approved");
        _safeTransfer(from, to, tokenId, _data);
    }

    /**
     * @dev Safely transfers `tokenId` token from `from` to `to`, checking first that contract recipients
     * are aware of the ERC721 protocol to prevent tokens from being forever locked.
     *
     * `_data` is additional data, it has no specified format and it is sent in call to `to`.
     *
     * This internal function is equivalent to {safeTransferFrom}, and can be used to e.g.
     * implement alternative mechanisms to perform token transfer, such as signature-based.
     *
     * Requirements:
     *
     * - `from` cannot be the zero address.
     * - `to` cannot be the zero address.
     * - `tokenId` token must exist and be owned by `from`.
     * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.
     *
     * Emits a {Transfer} event.
     */
    function _safeTransfer(
        address from,
        address to,
        uint256 tokenId,
        bytes memory _data
    ) internal virtual {
        _transfer(from, to, tokenId);
        require(_checkOnERC721Received(from, to, tokenId, _data), "ERC721: transfer to non ERC721Receiver implementer");
    }

    /**
     * @dev Returns whether `tokenId` exists.
     *
     * Tokens can be managed by their owner or approved accounts via {approve} or {setApprovalForAll}.
     *
     * Tokens start existing when they are minted (`_mint`),
     * and stop existing when they are burned (`_burn`).
     */
    function _exists(uint256 tokenId) internal view virtual returns (bool) {
        return _owners[tokenId] != address(0);
    }

    /**
     * @dev Returns whether `spender` is allowed to manage `tokenId`.
     *
     * Requirements:
     *
     * - `tokenId` must exist.
     */
    function _isApprovedOrOwner(address spender, uint256 tokenId) internal view virtual returns (bool) {
        require(_exists(tokenId), "ERC721: operator query for nonexistent token");
        address owner = ERC721.ownerOf(tokenId);
        return (spender == owner || getApproved(tokenId) == spender || isApprovedForAll(owner, spender));
    }

    /**
     * @dev Safely mints `tokenId` and transfers it to `to`.
     *
     * Requirements:
     *
     * - `tokenId` must not exist.
     * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.
     *
     * Emits a {Transfer} event.
     */
    function _safeMint(address to, uint256 tokenId) internal virtual {
        _safeMint(to, tokenId, "");
    }

    /**
     * @dev Same as {xref-ERC721-_safeMint-address-uint256-}[`_safeMint`], with an additional `data` parameter which is
     * forwarded in {IERC721Receiver-onERC721Received} to contract recipients.
     */
    function _safeMint(
        address to,
        uint256 tokenId,
        bytes memory _data
    ) internal virtual {
        _mint(to, tokenId);
        require(
            _checkOnERC721Received(address(0), to, tokenId, _data),
            "ERC721: transfer to non ERC721Receiver implementer"
        );
    }

    /**
     * @dev Mints `tokenId` and transfers it to `to`.
     *
     * WARNING: Usage of this method is discouraged, use {_safeMint} whenever possible
     *
     * Requirements:
     *
     * - `tokenId` must not exist.
     * - `to` cannot be the zero address.
     *
     * Emits a {Transfer} event.
     */
    function _mint(address to, uint256 tokenId) internal virtual {
        require(to != address(0), "ERC721: mint to the zero address");
        require(!_exists(tokenId), "ERC721: token already minted");

        _beforeTokenTransfer(address(0), to, tokenId);

        _balances[to] += 1;
        _owners[tokenId] = to;

        emit Transfer(address(0), to, tokenId);
    }

    /**
     * @dev Destroys `tokenId`.
     * The approval is cleared when the token is burned.
     *
     * Requirements:
     *
     * - `tokenId` must exist.
     *
     * Emits a {Transfer} event.
     */
    function _burn(uint256 tokenId) internal virtual {
        address owner = ERC721.ownerOf(tokenId);

        _beforeTokenTransfer(owner, address(0), tokenId);

        // Clear approvals
        _approve(address(0), tokenId);

        _balances[owner] -= 1;
        delete _owners[tokenId];

        emit Transfer(owner, address(0), tokenId);
    }

    /**
     * @dev Transfers `tokenId` from `from` to `to`.
     *  As opposed to {transferFrom}, this imposes no restrictions on msg.sender.
     *
     * Requirements:
     *
     * - `to` cannot be the zero address.
     * - `tokenId` token must be owned by `from`.
     *
     * Emits a {Transfer} event.
     */
    function _transfer(
        address from,
        address to,
        uint256 tokenId
    ) internal virtual {
        require(ERC721.ownerOf(tokenId) == from, "ERC721: transfer of token that is not own");
        require(to != address(0), "ERC721: transfer to the zero address");

        _beforeTokenTransfer(from, to, tokenId);

        // Clear approvals from the previous owner
        _approve(address(0), tokenId);

        _balances[from] -= 1;
        _balances[to] += 1;
        _owners[tokenId] = to;

        emit Transfer(from, to, tokenId);
    }

    /**
     * @dev Approve `to` to operate on `tokenId`
     *
     * Emits a {Approval} event.
     */
    function _approve(address to, uint256 tokenId) internal virtual {
        _tokenApprovals[tokenId] = to;
        emit Approval(ERC721.ownerOf(tokenId), to, tokenId);
    }

    /**
     * @dev Internal function to invoke {IERC721Receiver-onERC721Received} on a target address.
     * The call is not executed if the target address is not a contract.
     *
     * @param from address representing the previous owner of the given token ID
     * @param to target address that will receive the tokens
     * @param tokenId uint256 ID of the token to be transferred
     * @param _data bytes optional data to send along with the call
     * @return bool whether the call correctly returned the expected magic value
     */
    function _checkOnERC721Received(
        address from,
        address to,
        uint256 tokenId,
        bytes memory _data
    ) private returns (bool) {
        if (to.isContract()) {
            try IERC721Receiver(to).onERC721Received(_msgSender(), from, tokenId, _data) returns (bytes4 retval) {
                return retval == IERC721Receiver.onERC721Received.selector;
            } catch (bytes memory reason) {
                if (reason.length == 0) {
                    revert("ERC721: transfer to non ERC721Receiver implementer");
                } else {
                    assembly {
                        revert(add(32, reason), mload(reason))
                    }
                }
            }
        } else {
            return true;
        }
    }

    /**
     * @dev Hook that is called before any token transfer. This includes minting
     * and burning.
     *
     * Calling conditions:
     *
     * - When `from` and `to` are both non-zero, ``from``'s `tokenId` will be
     * transferred to `to`.
     * - When `from` is zero, `tokenId` will be minted for `to`.
     * - When `to` is zero, ``from``'s `tokenId` will be burned.
     * - `from` and `to` are never both zero.
     *
     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].
     */
    function _beforeTokenTransfer(
        address from,
        address to,
        uint256 tokenId
    ) internal virtual {}
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

import "../ERC721.sol";
import "./IERC721Enumerable.sol";

/**
 * @dev This implements an optional extension of {ERC721} defined in the EIP that adds
 * enumerability of all the token ids in the contract as well as all token ids owned by each
 * account.
 */
abstract contract ERC721Enumerable is ERC721, IERC721Enumerable {
    // Mapping from owner to list of owned token IDs
    mapping(address => mapping(uint256 => uint256)) private _ownedTokens;

    // Mapping from token ID to index of the owner tokens list
    mapping(uint256 => uint256) private _ownedTokensIndex;

    // Array with all token ids, used for enumeration
    uint256[] private _allTokens;

    // Mapping from token id to position in the allTokens array
    mapping(uint256 => uint256) private _allTokensIndex;

    /**
     * @dev See {IERC165-supportsInterface}.
     */
    function supportsInterface(bytes4 interfaceId) public view virtual override(IERC165, ERC721) returns (bool) {
        return interfaceId == type(IERC721Enumerable).interfaceId || super.supportsInterface(interfaceId);
    }

    /**
     * @dev See {IERC721Enumerable-tokenOfOwnerByIndex}.
     */
    function tokenOfOwnerByIndex(address owner, uint256 index) public view virtual override returns (uint256) {
        require(index < ERC721.balanceOf(owner), "ERC721Enumerable: owner index out of bounds");
        return _ownedTokens[owner][index];
    }

    /**
     * @dev See {IERC721Enumerable-totalSupply}.
     */
    function totalSupply() public view virtual override returns (uint256) {
        return _allTokens.length;
    }

    /**
     * @dev See {IERC721Enumerable-tokenByIndex}.
     */
    function tokenByIndex(uint256 index) public view virtual override returns (uint256) {
        require(index < ERC721Enumerable.totalSupply(), "ERC721Enumerable: global index out of bounds");
        return _allTokens[index];
    }

    /**
     * @dev Hook that is called before any token transfer. This includes minting
     * and burning.
     *
     * Calling conditions:
     *
     * - When `from` and `to` are both non-zero, ``from``'s `tokenId` will be
     * transferred to `to`.
     * - When `from` is zero, `tokenId` will be minted for `to`.
     * - When `to` is zero, ``from``'s `tokenId` will be burned.
     * - `from` cannot be the zero address.
     * - `to` cannot be the zero address.
     *
     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].
     */
    function _beforeTokenTransfer(
        address from,
        address to,
        uint256 tokenId
    ) internal virtual override {
        super._beforeTokenTransfer(from, to, tokenId);

        if (from == address(0)) {
            _addTokenToAllTokensEnumeration(tokenId);
        } else if (from != to) {
            _removeTokenFromOwnerEnumeration(from, tokenId);
        }
        if (to == address(0)) {
            _removeTokenFromAllTokensEnumeration(tokenId);
        } else if (to != from) {
            _addTokenToOwnerEnumeration(to, tokenId);
        }
    }

    /**
     * @dev Private function to add a token to this extension's ownership-tracking data structures.
     * @param to address representing the new owner of the given token ID
     * @param tokenId uint256 ID of the token to be added to the tokens list of the given address
     */
    function _addTokenToOwnerEnumeration(address to, uint256 tokenId) private {
        uint256 length = ERC721.balanceOf(to);
        _ownedTokens[to][length] = tokenId;
        _ownedTokensIndex[tokenId] = length;
    }

    /**
     * @dev Private function to add a token to this extension's token tracking data structures.
     * @param tokenId uint256 ID of the token to be added to the tokens list
     */
    function _addTokenToAllTokensEnumeration(uint256 tokenId) private {
        _allTokensIndex[tokenId] = _allTokens.length;
        _allTokens.push(tokenId);
    }

    /**
     * @dev Private function to remove a token from this extension's ownership-tracking data structures. Note that
     * while the token is not assigned a new owner, the `_ownedTokensIndex` mapping is _not_ updated: this allows for
     * gas optimizations e.g. when performing a transfer operation (avoiding double writes).
     * This has O(1) time complexity, but alters the order of the _ownedTokens array.
     * @param from address representing the previous owner of the given token ID
     * @param tokenId uint256 ID of the token to be removed from the tokens list of the given address
     */
    function _removeTokenFromOwnerEnumeration(address from, uint256 tokenId) private {
        // To prevent a gap in from's tokens array, we store the last token in the index of the token to delete, and
        // then delete the last slot (swap and pop).

        uint256 lastTokenIndex = ERC721.balanceOf(from) - 1;
        uint256 tokenIndex = _ownedTokensIndex[tokenId];

        // When the token to delete is the last token, the swap operation is unnecessary
        if (tokenIndex != lastTokenIndex) {
            uint256 lastTokenId = _ownedTokens[from][lastTokenIndex];

            _ownedTokens[from][tokenIndex] = lastTokenId; // Move the last token to the slot of the to-delete token
            _ownedTokensIndex[lastTokenId] = tokenIndex; // Update the moved token's index
        }

        // This also deletes the contents at the last position of the array
        delete _ownedTokensIndex[tokenId];
        delete _ownedTokens[from][lastTokenIndex];
    }

    /**
     * @dev Private function to remove a token from this extension's token tracking data structures.
     * This has O(1) time complexity, but alters the order of the _allTokens array.
     * @param tokenId uint256 ID of the token to be removed from the tokens list
     */
    function _removeTokenFromAllTokensEnumeration(uint256 tokenId) private {
        // To prevent a gap in the tokens array, we store the last token in the index of the token to delete, and
        // then delete the last slot (swap and pop).

        uint256 lastTokenIndex = _allTokens.length - 1;
        uint256 tokenIndex = _allTokensIndex[tokenId];

        // When the token to delete is the last token, the swap operation is unnecessary. However, since this occurs so
        // rarely (when the last minted token is burnt) that we still do the swap here to avoid the gas cost of adding
        // an 'if' statement (like in _removeTokenFromOwnerEnumeration)
        uint256 lastTokenId = _allTokens[lastTokenIndex];

        _allTokens[tokenIndex] = lastTokenId; // Move the last token to the slot of the to-delete token
        _allTokensIndex[lastTokenId] = tokenIndex; // Update the moved token's index

        // This also deletes the contents at the last position of the array
        delete _allTokensIndex[tokenId];
        _allTokens.pop();
    }
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

import "../ERC721.sol";
import "../../../utils/Context.sol";

/**
 * @title ERC721 Burnable Token
 * @dev ERC721 Token that can be irreversibly burned (destroyed).
 */
abstract contract ERC721Burnable is Context, ERC721 {
    /**
     * @dev Burns `tokenId`. See {ERC721-_burn}.
     *
     * Requirements:
     *
     * - The caller must own `tokenId` or be an approved operator.
     */
    function burn(uint256 tokenId) public virtual {
        //solhint-disable-next-line max-line-length
        require(_isApprovedOrOwner(_msgSender(), tokenId), "ERC721Burnable: caller is not owner nor approved");
        _burn(tokenId);
    }
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

import "../utils/Context.sol";

/**
 * @dev Contract module which provides a basic access control mechanism, where
 * there is an account (an owner) that can be granted exclusive access to
 * specific functions.
 *
 * By default, the owner account will be the one that deploys the contract. This
 * can later be changed with {transferOwnership}.
 *
 * This module is used through inheritance. It will make available the modifier
 * `onlyOwner`, which can be applied to your functions to restrict their use to
 * the owner.
 */
abstract contract Ownable is Context {
    address private _owner;

    event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);

    /**
     * @dev Initializes the contract setting the deployer as the initial owner.
     */
    constructor() {
        _setOwner(_msgSender());
    }

    /**
     * @dev Returns the address of the current owner.
     */
    function owner() public view virtual returns (address) {
        return _owner;
    }

    /**
     * @dev Throws if called by any account other than the owner.
     */
    modifier onlyOwner() {
        require(owner() == _msgSender(), "Ownable: caller is not the owner");
        _;
    }

    /**
     * @dev Leaves the contract without owner. It will not be possible to call
     * `onlyOwner` functions anymore. Can only be called by the current owner.
     *
     * NOTE: Renouncing ownership will leave the contract without an owner,
     * thereby removing any functionality that is only available to the owner.
     */
    function renounceOwnership() public virtual onlyOwner {
        _setOwner(address(0));
    }

    /**
     * @dev Transfers ownership of the contract to a new account (`newOwner`).
     * Can only be called by the current owner.
     */
    function transferOwnership(address newOwner) public virtual onlyOwner {
        require(newOwner != address(0), "Ownable: new owner is the zero address");
        _setOwner(newOwner);
    }

    function _setOwner(address newOwner) private {
        address oldOwner = _owner;
        _owner = newOwner;
        emit OwnershipTransferred(oldOwner, newOwner);
    }
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

// CAUTION
// This version of SafeMath should only be used with Solidity 0.8 or later,
// because it relies on the compiler's built in overflow checks.

/**
 * @dev Wrappers over Solidity's arithmetic operations.
 *
 * NOTE: `SafeMath` is no longer needed starting with Solidity 0.8. The compiler
 * now has built in overflow checking.
 */
library SafeMath {
    /**
     * @dev Returns the addition of two unsigned integers, with an overflow flag.
     *
     * _Available since v3.4._
     */
    function tryAdd(uint256 a, uint256 b) internal pure returns (bool, uint256) {
        unchecked {
            uint256 c = a + b;
            if (c < a) return (false, 0);
            return (true, c);
        }
    }

    /**
     * @dev Returns the substraction of two unsigned integers, with an overflow flag.
     *
     * _Available since v3.4._
     */
    function trySub(uint256 a, uint256 b) internal pure returns (bool, uint256) {
        unchecked {
            if (b > a) return (false, 0);
            return (true, a - b);
        }
    }

    /**
     * @dev Returns the multiplication of two unsigned integers, with an overflow flag.
     *
     * _Available since v3.4._
     */
    function tryMul(uint256 a, uint256 b) internal pure returns (bool, uint256) {
        unchecked {
            // Gas optimization: this is cheaper than requiring 'a' not being zero, but the
            // benefit is lost if 'b' is also tested.
            // See: https://github.com/OpenZeppelin/openzeppelin-contracts/pull/522
            if (a == 0) return (true, 0);
            uint256 c = a * b;
            if (c / a != b) return (false, 0);
            return (true, c);
        }
    }

    /**
     * @dev Returns the division of two unsigned integers, with a division by zero flag.
     *
     * _Available since v3.4._
     */
    function tryDiv(uint256 a, uint256 b) internal pure returns (bool, uint256) {
        unchecked {
            if (b == 0) return (false, 0);
            return (true, a / b);
        }
    }

    /**
     * @dev Returns the remainder of dividing two unsigned integers, with a division by zero flag.
     *
     * _Available since v3.4._
     */
    function tryMod(uint256 a, uint256 b) internal pure returns (bool, uint256) {
        unchecked {
            if (b == 0) return (false, 0);
            return (true, a % b);
        }
    }

    /**
     * @dev Returns the addition of two unsigned integers, reverting on
     * overflow.
     *
     * Counterpart to Solidity's `+` operator.
     *
     * Requirements:
     *
     * - Addition cannot overflow.
     */
    function add(uint256 a, uint256 b) internal pure returns (uint256) {
        return a + b;
    }

    /**
     * @dev Returns the subtraction of two unsigned integers, reverting on
     * overflow (when the result is negative).
     *
     * Counterpart to Solidity's `-` operator.
     *
     * Requirements:
     *
     * - Subtraction cannot overflow.
     */
    function sub(uint256 a, uint256 b) internal pure returns (uint256) {
        return a - b;
    }

    /**
     * @dev Returns the multiplication of two unsigned integers, reverting on
     * overflow.
     *
     * Counterpart to Solidity's `*` operator.
     *
     * Requirements:
     *
     * - Multiplication cannot overflow.
     */
    function mul(uint256 a, uint256 b) internal pure returns (uint256) {
        return a * b;
    }

    /**
     * @dev Returns the integer division of two unsigned integers, reverting on
     * division by zero. The result is rounded towards zero.
     *
     * Counterpart to Solidity's `/` operator.
     *
     * Requirements:
     *
     * - The divisor cannot be zero.
     */
    function div(uint256 a, uint256 b) internal pure returns (uint256) {
        return a / b;
    }

    /**
     * @dev Returns the remainder of dividing two unsigned integers. (unsigned integer modulo),
     * reverting when dividing by zero.
     *
     * Counterpart to Solidity's `%` operator. This function uses a `revert`
     * opcode (which leaves remaining gas untouched) while Solidity uses an
     * invalid opcode to revert (consuming all remaining gas).
     *
     * Requirements:
     *
     * - The divisor cannot be zero.
     */
    function mod(uint256 a, uint256 b) internal pure returns (uint256) {
        return a % b;
    }

    /**
     * @dev Returns the subtraction of two unsigned integers, reverting with custom message on
     * overflow (when the result is negative).
     *
     * CAUTION: This function is deprecated because it requires allocating memory for the error
     * message unnecessarily. For custom revert reasons use {trySub}.
     *
     * Counterpart to Solidity's `-` operator.
     *
     * Requirements:
     *
     * - Subtraction cannot overflow.
     */
    function sub(
        uint256 a,
        uint256 b,
        string memory errorMessage
    ) internal pure returns (uint256) {
        unchecked {
            require(b <= a, errorMessage);
            return a - b;
        }
    }

    /**
     * @dev Returns the integer division of two unsigned integers, reverting with custom message on
     * division by zero. The result is rounded towards zero.
     *
     * Counterpart to Solidity's `/` operator. Note: this function uses a
     * `revert` opcode (which leaves remaining gas untouched) while Solidity
     * uses an invalid opcode to revert (consuming all remaining gas).
     *
     * Requirements:
     *
     * - The divisor cannot be zero.
     */
    function div(
        uint256 a,
        uint256 b,
        string memory errorMessage
    ) internal pure returns (uint256) {
        unchecked {
            require(b > 0, errorMessage);
            return a / b;
        }
    }

    /**
     * @dev Returns the remainder of dividing two unsigned integers. (unsigned integer modulo),
     * reverting with custom message when dividing by zero.
     *
     * CAUTION: This function is deprecated because it requires allocating memory for the error
     * message unnecessarily. For custom revert reasons use {tryMod}.
     *
     * Counterpart to Solidity's `%` operator. This function uses a `revert`
     * opcode (which leaves remaining gas untouched) while Solidity uses an
     * invalid opcode to revert (consuming all remaining gas).
     *
     * Requirements:
     *
     * - The divisor cannot be zero.
     */
    function mod(
        uint256 a,
        uint256 b,
        string memory errorMessage
    ) internal pure returns (uint256) {
        unchecked {
            require(b > 0, errorMessage);
            return a % b;
        }
    }
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

/**
 * @dev String operations.
 */
library Strings {
    bytes16 private constant _HEX_SYMBOLS = "0123456789abcdef";

    /**
     * @dev Converts a `uint256` to its ASCII `string` decimal representation.
     */
    function toString(uint256 value) internal pure returns (string memory) {
        // Inspired by OraclizeAPI's implementation - MIT licence
        // https://github.com/oraclize/ethereum-api/blob/b42146b063c7d6ee1358846c198246239e9360e8/oraclizeAPI_0.4.25.sol

        if (value == 0) {
            return "0";
        }
        uint256 temp = value;
        uint256 digits;
        while (temp != 0) {
            digits++;
            temp /= 10;
        }
        bytes memory buffer = new bytes(digits);
        while (value != 0) {
            digits -= 1;
            buffer[digits] = bytes1(uint8(48 + uint256(value % 10)));
            value /= 10;
        }
        return string(buffer);
    }

    /**
     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation.
     */
    function toHexString(uint256 value) internal pure returns (string memory) {
        if (value == 0) {
            return "0x00";
        }
        uint256 temp = value;
        uint256 length = 0;
        while (temp != 0) {
            length++;
            temp >>= 8;
        }
        return toHexString(value, length);
    }

    /**
     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation with fixed length.
     */
    function toHexString(uint256 value, uint256 length) internal pure returns (string memory) {
        bytes memory buffer = new bytes(2 * length + 2);
        buffer[0] = "0";
        buffer[1] = "x";
        for (uint256 i = 2 * length + 1; i > 1; --i) {
            buffer[i] = _HEX_SYMBOLS[value & 0xf];
            value >>= 4;
        }
        require(value == 0, "Strings: hex length insufficient");
        return string(buffer);
    }
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

abstract contract ContextMixin {
    function msgSender()
        internal
        view
        returns (address payable sender)
    {
        if (msg.sender == address(this)) {
            bytes memory array = msg.data;
            uint256 index = msg.data.length;
            assembly {
                // Load the 32 bytes word from memory with the address on the lower 20 bytes, and mask those.
                sender := and(
                    mload(add(array, index)),
                    0xffffffffffffffffffffffffffffffffffffffff
                )
            }
        } else {
            sender = payable(msg.sender);
        }
        return sender;
    }
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

import {SafeMath} from  "@openzeppelin/contracts/utils/math/SafeMath.sol";
import {EIP712Base} from "./EIP712Base.sol";

contract NativeMetaTransaction is EIP712Base {
    using SafeMath for uint256;
    bytes32 private constant META_TRANSACTION_TYPEHASH = keccak256(
        bytes(
            "MetaTransaction(uint256 nonce,address from,bytes functionSignature)"
        )
    );
    event MetaTransactionExecuted(
        address userAddress,
        address payable relayerAddress,
        bytes functionSignature
    );
    mapping(address => uint256) nonces;

    /*
     * Meta transaction structure.
     * No point of including value field here as if user is doing value transfer then he has the funds to pay for gas
     * He should call the desired function directly in that case.
     */
    struct MetaTransaction {
        uint256 nonce;
        address from;
        bytes functionSignature;
    }

    function executeMetaTransaction(
        address userAddress,
        bytes memory functionSignature,
        bytes32 sigR,
        bytes32 sigS,
        uint8 sigV
    ) public payable returns (bytes memory) {
        MetaTransaction memory metaTx = MetaTransaction({
            nonce: nonces[userAddress],
            from: userAddress,
            functionSignature: functionSignature
        });

        require(
            verify(userAddress, metaTx, sigR, sigS, sigV),
            "Signer and signature do not match"
        );

        // increase nonce for user (to avoid re-use)
        nonces[userAddress] = nonces[userAddress].add(1);

        emit MetaTransactionExecuted(
            userAddress,
            payable(msg.sender),
            functionSignature
        );

        // Append userAddress and relayer address at the end to extract it from calling context
        (bool success, bytes memory returnData) = address(this).call(
            abi.encodePacked(functionSignature, userAddress)
        );
        require(success, "Function call not successful");

        return returnData;
    }

    function hashMetaTransaction(MetaTransaction memory metaTx)
        internal
        pure
        returns (bytes32)
    {
        return
            keccak256(
                abi.encode(
                    META_TRANSACTION_TYPEHASH,
                    metaTx.nonce,
                    metaTx.from,
                    keccak256(metaTx.functionSignature)
                )
            );
    }

    function getNonce(address user) public view returns (uint256 nonce) {
        nonce = nonces[user];
    }

    function verify(
        address signer,
        MetaTransaction memory metaTx,
        bytes32 sigR,
        bytes32 sigS,
        uint8 sigV
    ) internal view returns (bool) {
        require(signer != address(0), "NativeMetaTransaction: INVALID_SIGNER");
        return
            signer ==
            ecrecover(
                toTypedMessageHash(hashMetaTransaction(metaTx)),
                sigV,
                sigR,
                sigS
            );
    }
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

import "../../utils/introspection/IERC165.sol";

/**
 * @dev Required interface of an ERC721 compliant contract.
 */
interface IERC721 is IERC165 {
    /**
     * @dev Emitted when `tokenId` token is transferred from `from` to `to`.
     */
    event Transfer(address indexed from, address indexed to, uint256 indexed tokenId);

    /**
     * @dev Emitted when `owner` enables `approved` to manage the `tokenId` token.
     */
    event Approval(address indexed owner, address indexed approved, uint256 indexed tokenId);

    /**
     * @dev Emitted when `owner` enables or disables (`approved`) `operator` to manage all of its assets.
     */
    event ApprovalForAll(address indexed owner, address indexed operator, bool approved);

    /**
     * @dev Returns the number of tokens in ``owner``'s account.
     */
    function balanceOf(address owner) external view returns (uint256 balance);

    /**
     * @dev Returns the owner of the `tokenId` token.
     *
     * Requirements:
     *
     * - `tokenId` must exist.
     */
    function ownerOf(uint256 tokenId) external view returns (address owner);

    /**
     * @dev Safely transfers `tokenId` token from `from` to `to`, checking first that contract recipients
     * are aware of the ERC721 protocol to prevent tokens from being forever locked.
     *
     * Requirements:
     *
     * - `from` cannot be the zero address.
     * - `to` cannot be the zero address.
     * - `tokenId` token must exist and be owned by `from`.
     * - If the caller is not `from`, it must be have been allowed to move this token by either {approve} or {setApprovalForAll}.
     * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.
     *
     * Emits a {Transfer} event.
     */
    function safeTransferFrom(
        address from,
        address to,
        uint256 tokenId
    ) external;

    /**
     * @dev Transfers `tokenId` token from `from` to `to`.
     *
     * WARNING: Usage of this method is discouraged, use {safeTransferFrom} whenever possible.
     *
     * Requirements:
     *
     * - `from` cannot be the zero address.
     * - `to` cannot be the zero address.
     * - `tokenId` token must be owned by `from`.
     * - If the caller is not `from`, it must be approved to move this token by either {approve} or {setApprovalForAll}.
     *
     * Emits a {Transfer} event.
     */
    function transferFrom(
        address from,
        address to,
        uint256 tokenId
    ) external;

    /**
     * @dev Gives permission to `to` to transfer `tokenId` token to another account.
     * The approval is cleared when the token is transferred.
     *
     * Only a single account can be approved at a time, so approving the zero address clears previous approvals.
     *
     * Requirements:
     *
     * - The caller must own the token or be an approved operator.
     * - `tokenId` must exist.
     *
     * Emits an {Approval} event.
     */
    function approve(address to, uint256 tokenId) external;

    /**
     * @dev Returns the account approved for `tokenId` token.
     *
     * Requirements:
     *
     * - `tokenId` must exist.
     */
    function getApproved(uint256 tokenId) external view returns (address operator);

    /**
     * @dev Approve or remove `operator` as an operator for the caller.
     * Operators can call {transferFrom} or {safeTransferFrom} for any token owned by the caller.
     *
     * Requirements:
     *
     * - The `operator` cannot be the caller.
     *
     * Emits an {ApprovalForAll} event.
     */
    function setApprovalForAll(address operator, bool _approved) external;

    /**
     * @dev Returns if the `operator` is allowed to manage all of the assets of `owner`.
     *
     * See {setApprovalForAll}
     */
    function isApprovedForAll(address owner, address operator) external view returns (bool);

    /**
     * @dev Safely transfers `tokenId` token from `from` to `to`.
     *
     * Requirements:
     *
     * - `from` cannot be the zero address.
     * - `to` cannot be the zero address.
     * - `tokenId` token must exist and be owned by `from`.
     * - If the caller is not `from`, it must be approved to move this token by either {approve} or {setApprovalForAll}.
     * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.
     *
     * Emits a {Transfer} event.
     */
    function safeTransferFrom(
        address from,
        address to,
        uint256 tokenId,
        bytes calldata data
    ) external;
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

/**
 * @title ERC721 token receiver interface
 * @dev Interface for any contract that wants to support safeTransfers
 * from ERC721 asset contracts.
 */
interface IERC721Receiver {
    /**
     * @dev Whenever an {IERC721} `tokenId` token is transferred to this contract via {IERC721-safeTransferFrom}
     * by `operator` from `from`, this function is called.
     *
     * It must return its Solidity selector to confirm the token transfer.
     * If any other value is returned or the interface is not implemented by the recipient, the transfer will be reverted.
     *
     * The selector can be obtained in Solidity with `IERC721.onERC721Received.selector`.
     */
    function onERC721Received(
        address operator,
        address from,
        uint256 tokenId,
        bytes calldata data
    ) external returns (bytes4);
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

import "../IERC721.sol";

/**
 * @title ERC-721 Non-Fungible Token Standard, optional metadata extension
 * @dev See https://eips.ethereum.org/EIPS/eip-721
 */
interface IERC721Metadata is IERC721 {
    /**
     * @dev Returns the token collection name.
     */
    function name() external view returns (string memory);

    /**
     * @dev Returns the token collection symbol.
     */
    function symbol() external view returns (string memory);

    /**
     * @dev Returns the Uniform Resource Identifier (URI) for `tokenId` token.
     */
    function tokenURI(uint256 tokenId) external view returns (string memory);
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

/**
 * @dev Collection of functions related to the address type
 */
library Address {
    /**
     * @dev Returns true if `account` is a contract.
     *
     * [IMPORTANT]
     * ====
     * It is unsafe to assume that an address for which this function returns
     * false is an externally-owned account (EOA) and not a contract.
     *
     * Among others, `isContract` will return false for the following
     * types of addresses:
     *
     *  - an externally-owned account
     *  - a contract in construction
     *  - an address where a contract will be created
     *  - an address where a contract lived, but was destroyed
     * ====
     */
    function isContract(address account) internal view returns (bool) {
        // This method relies on extcodesize, which returns 0 for contracts in
        // construction, since the code is only stored at the end of the
        // constructor execution.

        uint256 size;
        assembly {
            size := extcodesize(account)
        }
        return size > 0;
    }

    /**
     * @dev Replacement for Solidity's `transfer`: sends `amount` wei to
     * `recipient`, forwarding all available gas and reverting on errors.
     *
     * https://eips.ethereum.org/EIPS/eip-1884[EIP1884] increases the gas cost
     * of certain opcodes, possibly making contracts go over the 2300 gas limit
     * imposed by `transfer`, making them unable to receive funds via
     * `transfer`. {sendValue} removes this limitation.
     *
     * https://diligence.consensys.net/posts/2019/09/stop-using-soliditys-transfer-now/[Learn more].
     *
     * IMPORTANT: because control is transferred to `recipient`, care must be
     * taken to not create reentrancy vulnerabilities. Consider using
     * {ReentrancyGuard} or the
     * https://solidity.readthedocs.io/en/v0.5.11/security-considerations.html#use-the-checks-effects-interactions-pattern[checks-effects-interactions pattern].
     */
    function sendValue(address payable recipient, uint256 amount) internal {
        require(address(this).balance >= amount, "Address: insufficient balance");

        (bool success, ) = recipient.call{value: amount}("");
        require(success, "Address: unable to send value, recipient may have reverted");
    }

    /**
     * @dev Performs a Solidity function call using a low level `call`. A
     * plain `call` is an unsafe replacement for a function call: use this
     * function instead.
     *
     * If `target` reverts with a revert reason, it is bubbled up by this
     * function (like regular Solidity function calls).
     *
     * Returns the raw returned data. To convert to the expected return value,
     * use https://solidity.readthedocs.io/en/latest/units-and-global-variables.html?highlight=abi.decode#abi-encoding-and-decoding-functions[`abi.decode`].
     *
     * Requirements:
     *
     * - `target` must be a contract.
     * - calling `target` with `data` must not revert.
     *
     * _Available since v3.1._
     */
    function functionCall(address target, bytes memory data) internal returns (bytes memory) {
        return functionCall(target, data, "Address: low-level call failed");
    }

    /**
     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`], but with
     * `errorMessage` as a fallback revert reason when `target` reverts.
     *
     * _Available since v3.1._
     */
    function functionCall(
        address target,
        bytes memory data,
        string memory errorMessage
    ) internal returns (bytes memory) {
        return functionCallWithValue(target, data, 0, errorMessage);
    }

    /**
     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],
     * but also transferring `value` wei to `target`.
     *
     * Requirements:
     *
     * - the calling contract must have an ETH balance of at least `value`.
     * - the called Solidity function must be `payable`.
     *
     * _Available since v3.1._
     */
    function functionCallWithValue(
        address target,
        bytes memory data,
        uint256 value
    ) internal returns (bytes memory) {
        return functionCallWithValue(target, data, value, "Address: low-level call with value failed");
    }

    /**
     * @dev Same as {xref-Address-functionCallWithValue-address-bytes-uint256-}[`functionCallWithValue`], but
     * with `errorMessage` as a fallback revert reason when `target` reverts.
     *
     * _Available since v3.1._
     */
    function functionCallWithValue(
        address target,
        bytes memory data,
        uint256 value,
        string memory errorMessage
    ) internal returns (bytes memory) {
        require(address(this).balance >= value, "Address: insufficient balance for call");
        require(isContract(target), "Address: call to non-contract");

        (bool success, bytes memory returndata) = target.call{value: value}(data);
        return verifyCallResult(success, returndata, errorMessage);
    }

    /**
     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],
     * but performing a static call.
     *
     * _Available since v3.3._
     */
    function functionStaticCall(address target, bytes memory data) internal view returns (bytes memory) {
        return functionStaticCall(target, data, "Address: low-level static call failed");
    }

    /**
     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],
     * but performing a static call.
     *
     * _Available since v3.3._
     */
    function functionStaticCall(
        address target,
        bytes memory data,
        string memory errorMessage
    ) internal view returns (bytes memory) {
        require(isContract(target), "Address: static call to non-contract");

        (bool success, bytes memory returndata) = target.staticcall(data);
        return verifyCallResult(success, returndata, errorMessage);
    }

    /**
     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],
     * but performing a delegate call.
     *
     * _Available since v3.4._
     */
    function functionDelegateCall(address target, bytes memory data) internal returns (bytes memory) {
        return functionDelegateCall(target, data, "Address: low-level delegate call failed");
    }

    /**
     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],
     * but performing a delegate call.
     *
     * _Available since v3.4._
     */
    function functionDelegateCall(
        address target,
        bytes memory data,
        string memory errorMessage
    ) internal returns (bytes memory) {
        require(isContract(target), "Address: delegate call to non-contract");

        (bool success, bytes memory returndata) = target.delegatecall(data);
        return verifyCallResult(success, returndata, errorMessage);
    }

    /**
     * @dev Tool to verifies that a low level call was successful, and revert if it wasn't, either by bubbling the
     * revert reason using the provided one.
     *
     * _Available since v4.3._
     */
    function verifyCallResult(
        bool success,
        bytes memory returndata,
        string memory errorMessage
    ) internal pure returns (bytes memory) {
        if (success) {
            return returndata;
        } else {
            // Look for revert reason and bubble it up if present
            if (returndata.length > 0) {
                // The easiest way to bubble the revert reason is using memory via assembly

                assembly {
                    let returndata_size := mload(returndata)
                    revert(add(32, returndata), returndata_size)
                }
            } else {
                revert(errorMessage);
            }
        }
    }
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

/**
 * @dev Provides information about the current execution context, including the
 * sender of the transaction and its data. While these are generally available
 * via msg.sender and msg.data, they should not be accessed in such a direct
 * manner, since when dealing with meta-transactions the account sending and
 * paying for execution may not be the actual sender (as far as an application
 * is concerned).
 *
 * This contract is only required for intermediate, library-like contracts.
 */
abstract contract Context {
    function _msgSender() internal view virtual returns (address) {
        return msg.sender;
    }

    function _msgData() internal view virtual returns (bytes calldata) {
        return msg.data;
    }
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

import "./IERC165.sol";

/**
 * @dev Implementation of the {IERC165} interface.
 *
 * Contracts that want to implement ERC165 should inherit from this contract and override {supportsInterface} to check
 * for the additional interface id that will be supported. For example:
 *
 * ```solidity
 * function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {
 *     return interfaceId == type(MyInterface).interfaceId || super.supportsInterface(interfaceId);
 * }
 * ```
 *
 * Alternatively, {ERC165Storage} provides an easier to use but more expensive implementation.
 */
abstract contract ERC165 is IERC165 {
    /**
     * @dev See {IERC165-supportsInterface}.
     */
    function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {
        return interfaceId == type(IERC165).interfaceId;
    }
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

/**
 * @dev Interface of the ERC165 standard, as defined in the
 * https://eips.ethereum.org/EIPS/eip-165[EIP].
 *
 * Implementers can declare support of contract interfaces, which can then be
 * queried by others ({ERC165Checker}).
 *
 * For an implementation, see {ERC165}.
 */
interface IERC165 {
    /**
     * @dev Returns true if this contract implements the interface defined by
     * `interfaceId`. See the corresponding
     * https://eips.ethereum.org/EIPS/eip-165#how-interfaces-are-identified[EIP section]
     * to learn more about how these ids are created.
     *
     * This function call must use less than 30 000 gas.
     */
    function supportsInterface(bytes4 interfaceId) external view returns (bool);
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

import "../IERC721.sol";

/**
 * @title ERC-721 Non-Fungible Token Standard, optional enumeration extension
 * @dev See https://eips.ethereum.org/EIPS/eip-721
 */
interface IERC721Enumerable is IERC721 {
    /**
     * @dev Returns the total amount of tokens stored by the contract.
     */
    function totalSupply() external view returns (uint256);

    /**
     * @dev Returns a token ID owned by `owner` at a given `index` of its token list.
     * Use along with {balanceOf} to enumerate all of ``owner``'s tokens.
     */
    function tokenOfOwnerByIndex(address owner, uint256 index) external view returns (uint256 tokenId);

    /**
     * @dev Returns a token ID at a given `index` of all the tokens stored by the contract.
     * Use along with {totalSupply} to enumerate all tokens.
     */
    function tokenByIndex(uint256 index) external view returns (uint256);
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

import {Initializable} from "./Initializable.sol";

contract EIP712Base is Initializable {
    struct EIP712Domain {
        string name;
        string version;
        address verifyingContract;
        bytes32 salt;
    }

    string constant public ERC712_VERSION = "1";

    bytes32 internal constant EIP712_DOMAIN_TYPEHASH = keccak256(
        bytes(
            "EIP712Domain(string name,string version,address verifyingContract,bytes32 salt)"
        )
    );
    bytes32 internal domainSeperator;

    // supposed to be called once while initializing.
    // one of the contracts that inherits this contract follows proxy pattern
    // so it is not possible to do this in a constructor
    function _initializeEIP712(
        string memory name
    )
        internal
        initializer
    {
        _setDomainSeperator(name);
    }

    function _setDomainSeperator(string memory name) internal {
        domainSeperator = keccak256(
            abi.encode(
                EIP712_DOMAIN_TYPEHASH,
                keccak256(bytes(name)),
                keccak256(bytes(ERC712_VERSION)),
                address(this),
                bytes32(getChainId())
            )
        );
    }

    function getDomainSeperator() public view returns (bytes32) {
        return domainSeperator;
    }

    function getChainId() public view returns (uint256) {
        uint256 id;
        assembly {
            id := chainid()
        }
        return id;
    }

    /**
     * Accept message hash and returns hash message in EIP712 compatible form
     * So that it can be used to recover signer from signature signed using EIP712 formatted data
     * https://eips.ethereum.org/EIPS/eip-712
     * "\\x19" makes the encoding deterministic
     * "\\x01" is the version byte to make it compatible to EIP-191
     */
    function toTypedMessageHash(bytes32 messageHash)
        internal
        view
        returns (bytes32)
    {
        return
            keccak256(
                abi.encodePacked("\x19\x01", getDomainSeperator(), messageHash)
            );
    }
}

// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

contract Initializable {
    bool inited = false;

    modifier initializer() {
        require(!inited, "already inited");
        _;
        inited = true;
    }
}